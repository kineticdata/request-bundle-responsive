<!-- Common Head Content -->
<%-- 
    Specify that modern IE versions should render the page with their own 
    rendering engine (as opposed to falling back to compatibility mode.
    NOTE: THIS HAS TO BE RIGHT AFTER <head>!
--%>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<%--
    Set the "Favicon" for the site.  Most modern browswers will associate this
    image with any bookmarks to the site, display the icon in tabs that are
    rendering the site, and may also display it in the URL bar.
--%>
<link rel="shortcut icon" href="<%=bundle.bundlePath()%>common/resources/images/favicon.png" type="image/x-icon" />

<%--
    Load the common bundle styling.  This will typically be loaded in the HEAD
    element before any package specific CSS, so it may be overriden with package
    specific styles.
--%>
<!-- Common Stylesheets Libraries -->
<link rel="stylesheet" type="text/css" href="<%=bundle.bundlePath()%>libraries/bootstrap/css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css" href="<%=bundle.bundlePath()%>libraries/jquery/jquery-ui-1.10.3.custom.min.css" />
<link rel="stylesheet" type="text/css" href="<%=bundle.bundlePath()%>libraries/font-awesome/css/font-awesome.min.css" />
<link rel="stylesheet" type="text/css" href="<%=bundle.bundlePath()%>libraries/jquery.qtip/jquery.qtip.min.css" />

<!-- Common Stylesheets -->
<link rel="stylesheet" type="text/css" href="<%=bundle.bundlePath()%>common/resources/css/common.css" />
<link rel="stylesheet" type="text/css" href="<%=bundle.bundlePath()%>common/resources/css/ajaxLogin.css" />

<%-- 
    Initialize the BUNDLE javascript object.  This object is used to store the
    configuration properties for requests in a manner that the client browser
    can access them after the initial page request has been made.
--%>
<!-- Configure the BUNDLE object and store the necessary configuration/state.-->
<script type="text/javascript">
    // Initialize the BUNDLE object.
    var BUNDLE = {};
    // Set the BUNDLE path properties
    BUNDLE.applicationPath = '<%=bundle.applicationPath()%>';
    BUNDLE.bundlePath = '<%=bundle.bundlePath()%>';
    BUNDLE.packagePath = '<%=bundle.packagePath()%>';
    BUNDLE.relativeBundlePath = '<%=bundle.relativeBundlePath()%>';
    BUNDLE.relativePackagePath = '<%=bundle.relativePackagePath()%>';
    // Initialize the BUNDLE configuration hash.
    BUNDLE.config = {};
    // Set all of the bundle configuration properties
    <% for (String name : bundle.propertyNames()) {%>
        <% if(bundle.getProperty(name) != null) {%>
            BUNDLE.config['<%=name%>'] = '<%= escapeEcmaScript(bundle.getProperty(name))%>';
        <%} else {%>
            BUNDLE.config['<%=name%>'] = <%=bundle.getProperty(name)%>;
        <%}%>
    <% }%>
    // Set any additional BUNDLE properties
    BUNDLE.config.user = '<%= (context == null) ? "" : context.getUserName()%>';
    
    // Define localization object
    var Localization = { <%= (bundle.getProperty("i18nValues") != null) ? bundle.getProperty("i18nValues") : "" %> };
    // Create .localize() string function.  This allows any JavaScript string to be
    // localized by adding ".localize()" to the end.  Examples: "hello".localize().
    String.prototype.localize = function() {
        var key = this.replace(/ /g, "_");
        var s = Localization[key];
        return ( s ) ? s : this;
    }
    // Define common require js configuration namespace
    BUNDLE.config.requireJs = {};
    // Setup common UI configurations
    BUNDLE.config.requireJs = {
        baseUrl: BUNDLE.bundlePath,
        paths: {
            placeholders: 'libraries/placeholders/placeholders.min',
            moment: 'libraries/moment/moment',
            jquery: 'libraries/jquery/jquery-1.11.0.min',
            jqueryUi: 'libraries/jquery/jquery-ui-1.10.3.custom.min',
            jqueryCookie: 'libraries/jquery.cookie/jquery.cookie',
            jqueryMd5: 'libraries/jquery.md5/jquery.md5',
            bootstrap: 'libraries/bootstrap/js/bootstrap.min',
            qtip: 'libraries/jquery.qtip/jquery.qtip.min',
            underscore: 'libraries/underscore/underscore-min',
            client: 'common/resources/js/client',
            ajaxLogin: 'common/resources/js/ajaxLogin',
            bridges: 'common/resources/js/Bridges',
            common: 'common/resources/js/common'
        },
        shim: {
            jqueryUi: {
                'export':'$',
                'deps' : ['jquery']
            },
            jqueryCookie: {
                'deps' : ['jquery']
            },
            jqueryMd5: {
                'deps' : ['jquery']
            },
            bootstrap: {
                'deps' : ['jquery']
            },
            qtip: {
                'deps' : ['jquery']
            },
            underscore: {
                'export' :'_'
            }
        }
    };
</script>

<!-- Common JavaScript Libraries -->
<!-- HTML5 modernizr for IE8 -->
<!--[if lt IE 9]>
<script type='text/javascript' src='<%=bundle.bundlePath()%>libraries/modernizr/modernizr.custom.js'></script>
<![endif]-->
<script type="text/javascript">
(function($) {
    $(function() {
        // Remove KDCACHE cookie until servlet stops creating it.
        $.removeCookie('KDCACHE-CHECK' + '<%=customerSurvey.getPageInstanceID()%>');
    });
});
</script>